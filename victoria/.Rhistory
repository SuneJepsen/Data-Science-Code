hist(data$Accident)
hist(data$Age)
hist(data$Accident)
hist(data$BAC)
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
age_ci
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
exp(age_ci)
summary(accident_gender)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = the_data)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = data)
summary(accident_gender)
coefficients(accident_age)
coefficients(accident_age)[2]
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint(accident_gender, parm = c("Gender"), level = 0.95)
exp(coefficients(accident_gender))
exp(confint.default(accident_gender))
exp(gender_ci)
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint(accident_gender, parm = c("Gender"), level = 0.95)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = data)
gender_ci <- confint(accident_gender, parm = c("Gender"), level = 0.95)
summary(accident_gender)
gender_ci <- confint(accident_gender, parm = c("Gender"), level = 0.95)
gender_coefficient <- coefficients(accident_gender)[2]
as.numeric(data$Gender)
accident_gender <- glm(formula = Accident ~ as.numeric(Gender), family = "binomial", data = data)
summary(accident_gender)
gender_ci <- confint(accident_gender, parm = c("Gender"), level = 0.95)
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
exp(gender_ci)
exp(gender_coefficient)
newData <- data
newData$Gender <- as.numeric(data$Gender)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = newData)
summary(accident_gender)
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
exp(gender_coefficient)
exp(gender_ci)
data$Gender
newData$Gender
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
gender_coefficient
exp(gender_coefficient)
exp(gender_ci)
as.numeric(data)
data_car_accidents <- read.xlsx("Data_Car_accidents.xlsx", 1)
data <- data_cat_accidents
data$Gender <- as.numeric(data_car_accidents$Gender)
data <- data_car_accidents
data$Gender <- as.numeric(data_car_accidents$Gender)
data$Accident <- as.numeric(data_car_accidents$Accident)
data$Socioeconomic_status <- as.numeric(data_car_accidents$Socioeconomic_status)
accident_age <- glm(formula = Accident ~ Age, family = "binomial", data = data)
summary(accident_age)
accident_age <- glm(formula = Accident ~ Age, family = "binomial", data = data)
data$Accident[data_car_accidents$Accident = "YES"] <- 1
data$Accident[data_car_accidents$Accident == "YES"] <- 1
data$Accident[data_car_accidents$Accident == "NO"] <- 0
data$Socioeconomic_status <- as.numeric(data_car_accidents$Socioeconomic_status)
View(data)
accident_age <- glm(formula = Accident ~ Age, family = "binomial", data = data)
summary(accident_age)
age_coefficient <- coefficients(accident_age)[2]
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
exp(age_coefficient)
exp(age_ci)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = data)
summary(accident_gender)
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
exp(gender_coefficient)
exp(gender_ci)
accident_socio <- glm(formula = Accident ~ Socioeconomic_status, family = "binomial", data = data)
summary(accident_gender)
summary(accident_socio)
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
gender_ci <- confint.default(accident_gender, parm = c("Socioeconomic_status"), level = 0.95)
exp(gender_coefficient)
exp(gender_ci)
socio_coefficient <- coefficients(accident_gender)[2]
socio_coefficient <- coefficients(accident_socio)[2]
socio_coefficient
socio_ci <- confint.default(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
exp(socio_coefficient)
exp(socio_ci)
accident_socio <- glm(formula = Accident ~ Socioeconomic_status, family = "binomial", data = data_car_accidents)
summary(accident_socio)
socio_coefficient <- coefficients(accident_socio)[2]
socio_ci <- confint.default(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
exp(socio_coefficient)
exp(socio_ci)
socio_ci <- confint(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
exp(socio_coefficient)
exp(socio_ci)
accident_socio <- glm(formula = Accident ~ Socioeconomic_status, family = "binomial", data = data)
summary(accident_socio)
socio_coefficient <- coefficients(accident_socio)[2]
socio_ci <- confint(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
exp(socio_coefficient)
exp(socio_ci)
t.test(BAC ~ Gender, alternative="two.sided", conf.level=0.95, var.equal=FALSE, data = data)
t.test(BAC ~ Age, alternative="two.sided", conf.level=0.95, var.equal=FALSE, data = data)
t.test(BAC, Age, alternative="two.sided", conf.level=0.95, var.equal=FALSE, data = data)
t.test(BAC, Age, alternative="two.sided", conf.level=0.95, var.equal=FALSE, data = data)
t.test(data$BAC, data$Age, alternative="two.sided")
t.test(data$BAC, data$Gender, alternative="two.sided")
t.test(data$BAC, data_car_accidents$Gender, alternative="two.sided")
t.test(data$BAC, data_car_accident$Gender, alternative="two.sided")
t.test(data$BAC, data_car_accidents$Gender, alternative="two.sided")
t.test(data$BAC, data$Age, alternative="two.sided")
t.test(data$BAC, data_car_accidents$Gender, alternative="two.sided")
t.test(data$BAC ~ data$Age, alternative="two.sided")
data$BAC ~ data$Age
t.test(BAC ~ Age, alternative="two.sided", data=data)
t.test(data_car_accident$BAC ~ data_car_accident$Age, alternative="two.sided")
t.test(data_car_accidents$BAC ~ data_car_accidents$Age, alternative="two.sided")
t.test(BAC ~ Age, alternative="two.sided", data=data_car_accidents)
data_car_accidents
bac_age <- glm(formula = BAC_. ~ Age, data = the_data)
bac_age <- glm(formula = BAC ~ Age, data = data)
summary(bac_age)
bac_gender <- glm(formula = BAC ~ Gender, data = data)
summary(bac_gender)
bac_age <- glm(formula = BAC ~ Age, familty= "binomial", data = data)
bac_age <- glm(formula = BAC ~ Age, family= "binomial", data = data)
bac_age <- glm(formula = BAC ~ Age, data = data)
summary(bac_age)
summary(bac_age)
summary(bac_gender)
accident_bac <- glm(formula = Accident ~ BAC, family = "binomial", data = data)
summary(accident_bac)
BAC_coefficient <- coefficients(accident_bac)[2]
BAC_coefficient
age_ci <- confint(accident_age, parm = c("BAC"), level=0.95)
age_ci <- confint.default(accident_age, parm = c("BAC"), level=0.95)
age_ci
bac_ci <- confint(accident_bac, parm = c("BAC"), level=0.95)
bac_ci
exp(bac_coefficient)
exp(bac_ci)
bac_coefficient <- coefficients(accident_bac)[2]
exp(bac_ci)
exp(bac_coefficient)
bac_ci <- confint.default(accident_bac, parm = c("BAC"), level=0.95)
exp(bac_ci)
bac_ci <- confint(accident_bac, parm = c("BAC"), level=0.95)
accident_bac_adjusted <- glm(formula = Accident ~ BAC + Gender + Age, family = "binomial", data = data)
summary(accident_bac_adjusted)
adjusted_coefficient <- coefficients(accident_bac)
adjusted_coefficient
adjusted_coefficient <- coefficients(accident_bac_adjusted)
adjusted_coefficient
adjusted_ci <- confint(accident_bac, parm = c("BAC", "Gender", "Age"), level=0.95)
adjusted_ci <- confint(accident_bac_adjusted, parm = c("BAC", "Gender", "Age"), level=0.95)
adjusted_ci
accident_bac_adjusted <- glm(formula = Accident ~ BAC + Gender + Age, family = "binomial", data = data_car_accidents)
summary(accident_bac_adjusted)
adjusted_coefficient <- coefficients(accident_bac_adjusted)
adjusted_ci <- confint(accident_bac_adjusted, parm = c("BAC", "Gender", "Age"), level=0.95)
adjusted_coefficient
exp(coefficient)
adjusted_coefficient
adjusted_ci
exp(adjusted_coefficient)
exp(adjusted_ci)
accident_bac
plot(data$BAC, accident_bac)
fitted.values(accident_bac)
plot(data$BAC, fitted.values(accident_bac))
plot(data$BAC, fitted.values(accident_bac_adjusted))
forty_years <- data.frame(Age = 40, Gender = "Male")
forty_years <- data.frame(BAC = 1, Age = 40, Gender = "Male")
forty_years <- data.frame(BAC > 1, Age = 40, Gender = "Male")
forty_years <- data.frame(BAC > 1, Age = 40, Gender = "Male", data=data)
str(data)
str(data_car_accidents)
forty_years <- data.frame(BAC > 1, Age = 40, Gender = "Male", data=data_car_accidents)
forty_years <- data.frame(BAC = 1, Age = 40, Gender = "Male", data=data_car_accidents)
fitted(accident_bac_adjusted, forty_years)
predict(accident_bac_adjusted, forty_years)
predict(accident_bac_adjusted, forty_years, type="response")
forty_years <- data.frame(BAC = 1, Age = 40, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, forty_years, type="response")
predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 2, Age = 40, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 1, Age = 40, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, forty_years, type="response")[1]
plot(data$BAC, fitted.values(accident_bac_adjusted))
forty_years <- data.frame(BAC >= 1, Age = 40, Gender = "Male", data=data_car_accidents)
forty_years <- data.frame(BAC = 1.0, Age = 40, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, forty_years, type="response")[1]
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 1.0, Age = 50, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 1.68, Age = 50, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 1.0, Age = 50, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 0.323, Age = 40, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 0.323, Age = 40, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years <- data.frame(BAC = 1.0, Age = 40, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, forty_years, type="response")[1]
forty_years_1 <- data.frame(BAC = 0.0, Age = 40, Gender = "Male", data=data_car_accidents)
forty_years_0 <- data.frame(BAC = 1.0, Age = 40, Gender = "Male", data=data_car_accidents)
forty_years_1 <- data.frame(BAC = 0.0, Age = 40, Gender = "Male", data=data_car_accidents)
1-(predict(accident_bac_adjusted, forty_years_0, type="response")[1] + predict(accident_bac_adjusted, forty_years_1, type="response")[1])
accident_predict = function(x) {
years_0 <- data.frame(BAC = 1.0, Age = x, Gender = "Male", data=data_car_accidents)
years_1 <- data.frame(BAC = 0.0, Age = x, Gender = "Male", data=data_car_accidents)
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
accident_predict(40)
accident_predict(50)
accident_predict(60)
plot(data$Age, fitted.values(accident_bac_adjusted))
plot(data$BAC, fitted.values(accident_bac_adjusted))
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male", data=data_car_accidents)
1-(predict(accident_bac_adjusted, years_0, type="response")[1]
accident_predict(40)
accident_predict(50)
accident_predict(60)
years_0 <- data.frame(BAC = 0.0, Age = 40, Gender = "Male", data=data_car_accidents)
1-(predict(accident_bac_adjusted, years_0, type="response")[1]
accident_predict(40)
accident_predict(50)
accident_predict(60)
years_0 <- data.frame(BAC = 0.0, Age = 40, Gender = "Male", data=data_car_accidents)
1-(predict(accident_bac_adjusted, years_0, type="response")[1])
predict(accident_bac_adjusted, years_0, type="response")[1]
years_0 <- data.frame(BAC = 0.0, Age = 80, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, years_0, type="response")[1]
years_0 <- data.frame(BAC = 1.0, Age = 80, Gender = "Male", data=data_car_accidents)
predict(accident_bac_adjusted, years_0, type="response")[1]
accident_predict(70)
accident_predict(70)[1]
fourtyY <- data.frame(BAC = 1.072, Age = 40, Gender = "Male", data=data_car_accidents)
1-predict(accident_bac_adjusted, fourtyY, type="response")[1]
accident_predict(40)
accident_predict(40)
accident_predict(50)
accident_predict(60)
accident_predict(70)
a <- accident_predict(40)
b <- accident_predict(50)
age = <- c(40,50,60,70,80)
age <- c(40,50,60,70,80)
accident_predict(age)
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male", data=data_car_accidents)
years_1 <- data.frame(BAC = 1.0, Age = x, Gender = "Male", data=data_car_accidents)
result <- (predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male", data=data_car_accidents)
years_1 <- data.frame(BAC = 1.0, Age = x, Gender = "Male", data=data_car_accidents)
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 40, Gender = "Male", data=data_car_accidents), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 50, Gender = "Male", data=data_car_accidents), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 60, Gender = "Male", data=data_car_accidents), type="response")[1]
newData <- read.xlsx("Data_Car_accidents.xlsx", 2)
newData
plot(data$BAC, fitted.values(accident_bac_adjusted))
summary(accident_bac_adjusted)
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
data
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 40, Gender = 2, data=data), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 40, Gender = "Male", data=data), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 40, Gender = "Male"), type="response")[1]
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male")
years_1 <- data.frame(BAC = 1.0, Age = x, Gender = "Male")
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 40, Gender = "Male"), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 50, Gender = "Male", data=data_car_accidents), type="response")[1]
predict(accident_bac_adjusted, data.frame(BAC = 1.0, Age = 60, Gender = "Male", data=data_car_accidents), type="response")[1]
data
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
data_car_accidents <- read.xlsx("Data_Car_accidents.xlsx", 1)
data <- data_car_accidents
data$Gender <- as.numeric(data_car_accidents$Gender)
data_car_accidents <- read.xlsx("Data_Car_accidents.xlsx", 1)
data <- data_car_accidents
data$Accident[data_car_accidents$Accident == "YES"] <- TRUE
data$Accident[data_car_accidents$Accident == "NO"] <- FALSE
data$Accident[data_car_accidents$Accident == "YES"] <- 1
data$Accident[data_car_accidents$Accident == YES] <- 1
data$Accident[data_car_accidents$Accident == "YES"] <- 1
data_car_accidents <- read.xlsx("Data_Car_accidents.xlsx", 1)
data <- data_car_accidents
data$Accident[data_car_accidents$Accident == "YES"] <- 1
data$Accident[data$Accident == "YES"] <- 1
data$Gender <- as.numeric(data_car_accidents$Gender)
data$Accident[data$Accident == "YES"] <- 1
data$Accident[data_car_accidents$Accident == "NO"] <- FALSE
data$Accident[data$Accident == "YES"] <- "Hey"
data$Accident[data$Accident == "YES"] = 1
View(data)
data$Accident[data_car_accidents$Accident == "YES"] <- 1
View(data)
data$Accident[data_car_accidents$Accident == "YES"] <- "OK"
View(data)
data_car_accidents <- read.xlsx("Data_Car_accidents.xlsx", 1)
data <- data_car_accidents
data$Accident[data$Accident == "YES"] <- "OK"
data$Accident <- as.numeric(data_car_accidents$Accident)
data$Accident[data$Accident == "YES"] <- "OK"
data$Accident <- as.numeric(data_car_accidents$Accident)
data$Accident[data$Accident == 1] <- 0
data$Accident[data$Accident == 2] <- 1
View(data)
accident_age <- glm(formula = Accident ~ Age, family = "binomial", data = data)
summary(accident_age)
age_coefficient <- coefficients(accident_age)[2]
age_coefficient
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
age_ci <- confint(accident_age, parm = c("Age"), level=0.95)
age_ci
exp(age_coefficient)
exp(age_ci)
accident_gender <- glm(formula = Accident ~ Gender, family = "binomial", data = data)
summary(accident_gender)
gender_coefficient <- coefficients(accident_gender)[2]
gender_ci <- confint.default(accident_gender, parm = c("Gender"), level = 0.95)
gender_ci
gender_ci <- confint.default(accident_gender, parm = c("GenderMale"), level = 0.95)
gender_ci
exp(gender_coefficient)
exp(gender_ci)
accident_socio <- glm(formula = Accident ~ Socioeconomic_status, family = "binomial", data = data)
summary(accident_socio)
socio_ci <- confint(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
str(data)
socio_ci <- confint.default(accident_socio, parm = c("Socioeconomic_status"), level = 0.95)
exp(socio_ci)
gender_ci <- confint(accident_gender, parm = c("GenderMale"), level = 0.95)
exp(gender_ci)
exp(gender_coefficient)
accident_socio <- glm(formula = Accident ~ Socioeconomic_status, family = "binomial", data = data)
summary(accident_socio)
socio_ci <- confint(accident_socio, parm = c("Socioeconomic_statusMiddle", "Socioeconomic_statusUpper"), level = 0.95)
exp(socio_coefficient)
socio_coefficient <- coefficients(accident_socio)[2]
exp(socio_coefficient)
socio_coefficient <- coefficients(accident_socio)
exp(socio_coefficient)
exp(socio_ci)
bac_age <- glm(formula = BAC ~ Age, data = data)
summary(bac_age)
bac_gender <- glm(formula = BAC ~ Gender, data = data)
summary(bac_gender)
accident_bac <- glm(formula = Accident ~ BAC, family = "binomial", data = data)
summary(accident_bac)
bac_coefficient <- coefficients(accident_bac)[2]
bac_coefficient
bac_ci <- confint(accident_bac, parm = c("BAC"), level=0.95)
bac_ci
exp(bac_coefficient)
exp(bac_ci)
accident_bac_adjusted <- glm(formula = Accident ~ BAC + Gender + Age, family = "binomial", data = data)
summary(accident_bac_adjusted)
adjusted_coefficient <- coefficients(accident_bac_adjusted)
adjusted_coefficient
adjusted_ci <- confint(accident_bac_adjusted, parm = c("BAC", "Gender", "Age"), level=0.95)
adjusted_ci <- confint(accident_bac_adjusted, parm = c("BAC", "GenderMale", "Age"), level=0.95)
adjusted_ci
exp(adjusted_coefficient)
exp(adjusted_ci)
plot(data$BAC, fitted.values(accident_bac))
plot(data$BAC, fitted.values(accident_bac_adjusted))
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male")
years_1 <- data.frame(BAC = 1.0, Age = x, Gender = "Male")
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
summary(accident_bac_adjusted)
years_0 <- data.frame(BAC = 0.0, Age = x, GenderMale = "Male")
years_1 <- data.frame(BAC = 1.0, Age = x, GenderMale = "Male")
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, GenderMale = "Male")
years_1 <- data.frame(BAC = 1.0, Age = x, GenderMale = "Male")
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
accident_predict = function(x) {
years_0 <- data.frame(BAC = 0.0, Age = x, Gender = "Male")
years_1 <- data.frame(BAC = 1.0, Age = x, Gender = "Male")
result <- 1-(predict(accident_bac_adjusted, years_0, type="response")[1] + predict(accident_bac_adjusted, years_1, type="response")[1])
return(result)
}
age <- c(40,50,60,70,80)
accident <- c(accident_predict(40),accident_predict(50),accident_predict(60),accident_predict(70),accident_predict(80))
plot(age,accident)
plot(data$Age, data$Accident)
cumsum(data$Accident)
plot(data$Age, cumsum(data$Accident))
order(data, Age)
order(data, data$Age)
data[with(data, order(Age))]
data[with(data, order(data$Age))]
data[order(data$Age),]
newData <- data[order(data$Age),]
cumsum(newData$Accident)
plot(newData$Age, cumsum(data$Accident))
plot(data$BAC, fitted.values(accident_bac_adjusted))
plot(data$BAC, fitted.values(accident_bac))
plot(data$Age, fitted.values(accident_bac_adjusted))
plot(data$BAC, fitted.values(accident_bac_adjusted))
plot(age,accident)
p1 <- accident_predict(40)
p2 <- accident_predict(50)
p3 <- accident_predict(60)
p4 <- accident_predict(70)
p5 <- accident_predict(80)
accident <- c(p1-p2,p3-p2,p4-p3,p5-p4)
plot(age,accident)
age <- c(40,50,60,70)
accident <- c(p1-p2,p3-p2,p4-p3,p5-p4)
plot(age,accident)
p1
p2
p3
p4
p5
accident <- c(p1-p2,p2-p3,p3-p4,p4-p5)
plot(age,accident)
predict(accident_bac_adjusted)
newData
pred <- predict(accident_bac_adjusted)
pred.glm <- rep(0, length(pred))
pred.glm[pred > 0.5] <- 1
table(pred.glm, newData$Accident)
pred <- predict(accident_bac_adjusted, newdata=newData, type="response", interval="prediction")
pred
pred <- predict(accident_bac_adjusted, newData, type="response", interval="prediction")
pred
pred <- predict(accident_bac_adjusted, newData, type="response")
pred
str(data)
str(newData)
newData <- read.xlsx("Data_Car_accidents.xlsx", sheetIndex=2)
pred <- predict(accident_bac_adjusted, newData, type="response")
str(newData)
newData$Accident <- as.numeric(newData$Accident)
newData$Accident[newData$Accident == 1] <- 0
newData$Accident[newData$Accident == 2] <- 1
View(newData)
newData <- read.xlsx("Data_Car_accidents.xlsx", sheetIndex=2)
newData$Accident <- as.numeric(newData$Accident)
newData$Accident[newData$Accident == 1] <- 0
newData$Accident[newData$Accident == 2] <- 1
str(newData)
pred <- predict(accident_bac_adjusted, newData, type="response")
pred
pred.glm <- rep(0, length(pred))
pred.glm[pred > 0.5] <- 1
table(pred.glm, newData$Accident)
(8+4)/17
pred.glm[pred > 0.5] <- 2
table(pred.glm, newData$Accident)
pred.glm[pred > 0.5] <- 1
table(newData$Accident, pred.glm)
pred.glm[pred > 0.5] <- 2
table(newData$Accident, pred.glm)
pred.glm[pred > 0.5] <- 1
table(newData$Accident, pred.glm)
4/(4+4)
4/(1+4)
TN <- 8
FN <- 4
FP <- 1
TÅ <- 4
TÅ <- 4
TP <- 4
(TN+TP)/(TN+FP+FN+TP)
TP/(FP+TP)
TP/(TP+FN)
TN/(TN+FP)
